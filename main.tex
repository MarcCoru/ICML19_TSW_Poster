\documentclass[a0]{tumposter}

\usepackage[english]{babel}

\usepackage{blindtext}

\usepackage{multicol}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{natbib}

% for printing fontsizes
\usepackage{printlen}
\uselengthunit{mm}

\input{preamble.tex}

\usepackage[utf8]{inputenc}

\title{
	BreizhCrops: A Satellite Time Series Dataset \\ for Crop Type Identification
	}
	
\author{
	Marc Rußwurm,
	Sébastien Lefèvre,
	Marco Körner
	}

\header{
	Remote Sensing Technology \\
	TUM Department of Civil, Geo and Environmental Engineering \\
	Technical University of Munich
	}
	
\begin{document}
\maketitle

%\newcommand{\satellitebox}{
%	\begin{tikzpicture}[node distance=1em]
%	\node(title){Satellite Data $\V{x}$};
%	\node[below=of title](s2){\includegraphics[width=15cm]{images/sentinel2}};
%	\node[below=of s2, text width=20cm]{
%	ESA Sentinel 2 Satellite
%	\begin{itemize}\setlength\itemsep{.1em}
%		\item 13 spectral bands
%		\item every 2-10 days
%		\item global coverage
%		\item free of charge	
%	\end{itemize}
%};
%\end{tikzpicture}
%}

%\newcommand{\modelbox}{
%	\begin{tikzpicture}[node distance=1em]
%\node(title){classification model $f$};
%\node[below=of title](large){\includegraphics[width=15cm]{images/Large1954_cerial_growth_stages.png}};
%\node[below=of large](label){learning a phenological model};
%
%\node[below=3em of label, xshift=-5em, anchor=east]{?};
%\node[below=3em of label, anchor=center]{health};
%\node[below=3em of label, xshift=5em, anchor=west]{droughts};
%
%
%\end{tikzpicture}
%}

%\newcommand{\labelbox}{
%\begin{tikzpicture}[node distance=1em]
%\node(title){crop type labels $\V{y}$};
%\node[below=of title](large){\includegraphics[width=15cm]{images/map/parcels}};
%\node[below=of large, text width=20cm]{
%Crop Type Labels
%\begin{itemize}\setlength\itemsep{.1em}
%\item Europes Common Agricultural Policy (CAP)
%\item reported by respective farmer
%\item gathered by national institutions (IGN in France)
%\end{itemize}
%};
%\end{tikzpicture}
%}

\begin{minipage}[t]{0.65\textwidth}

\section{The Objective}

\begin{tikzpicture}[scale=16]
	\node[label={[name=sat]Satellite Data}](x) at (-1,0){$\M{X} = (\V{x}_0, \V{x}_1, \dots , \V{x}_T)$};
	\node[below=of x, label={[yshift=1.3em, xshift=1.8em, font=\tiny, text=white]below:ESA Sentinel 2 Satellite}](s2){\includegraphics[width=13cm]{images/sentinel2}};

	
	\node[below=of s2, text width=13cm](eqbox){
		surface reflectance
		\centering
		$
		\rho_\lambda = 
		\frac{
			\pi L_\lambda d^2
		}
		{
			E_\text{sun} \cos(\varphi_\text{sun})
		}
		$
		
%		\begin{tikzpicture}[scale=3.5, anchor=center]
%		
%%			\node at (0,0){};
%			\node(eq) at (0,0) {
%
%				};
%		\end{tikzpicture}
		\includegraphics[width=7cm]{images/reflectance}
%		\vspace{1em}
		
		in N=13 spectral bands
		$\V{x}_t = \tiny \left(\rho_{\text{red}},\rho_{\text{green}},\rho_{\text{nir}},\dots\right)$
	};
	
	\node[label={[name=cm]Classification Model}](f) at (0,0){ $\V{y} = f(\M{x})$};
	\node[below=of f](large){\includegraphics[width=13cm]{images/Large1954_cerial_growth_stages.png}};
	\node[below=of large, circle, fill=tumbluedark, text=white, text width=10cm](label){learning a \\ \textbf{\Large\color{tumorange}vegetation} \color{tumwhite} model $f$};
	\node[below=of label, xshift=-3em, yshift=1em, rotate=0, text=tumgraydark](yield){yield?};
	\node[below=of label, text=tumgraydark](prod){production?};
	\node[below=of label, xshift=3em, yshift=1em, text=tumgraydark](health){health?};
	\node[fit=(yield)(prod)(health), draw=none, rounded corners, label={[anchor=north, font=\tiny, xshift=3em, yshift=.75em, text=tumblue]south:\#foodsecurity}](foodsec){};
	

	\node[label={[name=ctm]Crop Type Labels}](y) at (1,0){$\V{y} \in \small \{\text{corn}, \text{meadows}, \dots\}$};
	\node[below=of y, label=below:IGN crop type labels](labels){\includegraphics[width=13cm]{images/map/parcels}};
	\node[below=of labels, text width=12cm](lbls){
		\small
	\begin{itemize}\setlength\itemsep{.1em}
		\item collected in entire Europe
		\item Europes Common Agricultural Policy (CAP)
		\item reported by respective farmer
		\item yearly data
		\item slowly made publicly available (INSPIRE)
	\end{itemize}
	};
	
	\draw[thin, -{Stealth[scale=.5]}, tumblue] (x) -- (f);
	\draw[thin, -{Stealth[scale=.5]}, tumblue] (f) -- (y);
	
	\scoped[on background layer]
	{
		\node[fit=(cm)(foodsec), fill=tumgraylight, inner sep=1em, rounded corners]{};
		\node[fit=(ctm)(lbls), fill=tumgraylight, inner sep=1em, rounded corners]{};
		\node[fit=(sat)(eqbox), fill=tumgraylight, inner sep=1em, rounded corners]{};
	}	
	
\end{tikzpicture}

\section{The Data}
Brittany, France (\textit{Breizh} in local language)

%\subsection{Labels}
\small \textbf{Labels} 580k field parcels with 13 crop categories

\begin{tikzpicture}[node distance=0em]
	\node[label={[text width=14cm, yshift=0ex]above:\tiny field parcels in Brittany colored by crop type label}](a){\includegraphics[width=14cm]{images/map/breizh}};
	\node[right=of a, label={[text width=14cm, yshift=0ex]above:\tiny administrative divisions of Brittany used for \textbf{spatially separate} \textbf{train/test} \textbf{split}}](b){\includegraphics[width=14cm]{images/map/regions}};
	\node[right=of b, label={[text width=14cm, yshift=0ex]above:\tiny {\color{tumorange}Brittany} and {\color{tumblue} other regions} releasing anonymized crop type labels}, text width=14cm](d){\includegraphics[width=15cm]{images/map/europe_data2.pdf}};
%	\node[right=of b](c){
%		\small
%			\begin{tabular}{lrr}
%			\toprule
%			Departements & Parcels \\
%			\cmidrule(lr){1-1}\cmidrule(lr){2-2}\cmidrule(lr){3-3}
%			%			\midrule
%			Morbihan & 158522 \\
%			Côtes-d’Armor & 221095 \\
%			Finistère & 180565\\
%			Ille-et-Vilaine & 207993\\
%			\bottomrule
%			\end{tabular}	
%		};
	\node[below=of b](histogram){
	\input{images/partition_histograms.tikz}
	};

	\scoped[on background layer]
	{
		\node[fit=(a)(b)(d)(histogram), fill=tumgraylight, inner sep=1em, rounded corners]{};
%		\node[fit=(ctm)(lbls), fill=tumgraylight, inner sep=1em, rounded corners]{};
%		\node[fit=(sat)(eqbox), fill=tumgraylight, inner sep=1em, rounded corners]{};
	}	
	
\end{tikzpicture}
 \small \textbf{Time Series} 70-150 surface reflectance measurements in 13 spectral bands for each parcel of the season 2017


\begin{tikzpicture}[xscale=12, yscale=-4]
\input{images/example.tikz}
\node[label={[yshift=.75em]below:\tiny corn parcel}](a) at (-1,0){\examplecorn};
\node[label={[yshift=.75em]below:\tiny meadow parcel}](b) at (1,0){\examplemeadows};
\node at (0,-1){\includegraphics[]{images/legend_x2}};
\end{tikzpicture}

\end{minipage}
\hfill
\begin{minipage}[t]{0.32\textwidth}
	
	\section{The Baseline Results}
	
	We show the feasibility of classifying this dataset with \textbf{\color{tumblue}LSTM} \citep{hochreiter1997long} and \textbf{\color{tumorange}Tranformer} \citep{Vaswani:Transformer} baselines.
	
%	\input{images/lstmmodel.tikz}
%	\lstmmodel
%	\transformermodel
	
	\vspace{1em}
	\centering
	Comparison of Baseline Models
	\begin{tikzpicture}
		\node[rounded corners]{
		\begin{tabular}{lccccccc}
		\toprule
		method & acc & $\kappa$ & $f_1$ & prec.  & rec. \\
		\cmidrule(lr){1-1}\cmidrule(lr){2-2}\cmidrule(lr){3-3}\cmidrule(lr){4-4}\cmidrule(lr){5-5}\cmidrule(lr){6-6}\cmidrule(lr){7-7}
		Transformer & \textbf{0.69}  &  \textbf{0.63} & 0.57 & {0.60} & 0.56 \\
		LSTM & 0.68 & 0.62 & \textbf{0.59} & \textbf{0.63} & \textbf{0.58} \\
		\bottomrule
		\end{tabular}
		};
	\end{tikzpicture}

	\vspace{1em}
	
	\tikzstyle{crop} = [fill=tumbluelight, rounded corners]
	
	Class-wise results of the LSTM model.
	\begin{tikzpicture}[xscale=6, yscale=15]
		\node[] at (0,0){{\small\input{images/data/BreizhCrops_rnn/npy/table.tex}}};
		\node[rounded corners, label=below:\small precision] at (-1,-1){\resizebox{12cm}{!}{\confmat{images/data/BreizhCrops_rnn/npy/confmat_flat.csv}{3}{1}}};
		\node[rounded corners, label=below:\small recall] at (1,-1){\resizebox{12cm}{!}{\confmat{images/data/BreizhCrops_rnn/npy/confmat_flat.csv}{4}{1}}};
	\end{tikzpicture}




	
	

%Some categories can be traced to one unique type of crop, such as \textsl{wheat}, or \textsl{corn}. 
%	Here, the phenological characteristics can be traced to single specific crop types.
%	Other, less frequent classes, are aggregated into groups that incorporate a broader range of vegetation types which may be difficult to distinguish, such as \emph{orchards}.
%	
%	\subsection{Clouds introduce noise}

%	\textbf{Non-Gaussian noise induced by clouds}. Clouds cover the Earth's surface at regular intervals. Their large reflectance introduces a positive non-gaussian noise to the data at single intervals. 
%	This manifests itself by positive outliers in the reflectance data over the time scale, as can be seen in the examples of \cref{fig:aoi}.
%	

%	\textbf{Regional Variations in class distributions and imbalanced class labels}
%	\textbf{Regional variations in the class distributions}. Regional variances in soil quality, elevation, temperature, and precipitation lead to a spatial correlation in the frequency of dominated agricultural crop. This effect increases at larger scales where these environmental conditions change significantly.
%	Still, certain variations in crop distributions based on regionally distinct regions can be seen in \cref{fig:classfrequencies}.
	
%	\input{images/partition_histograms.tikz}
	
%	
%	\begin{tikzpicture}
%		\node at (0,1){
%			
%		};
%	\end{tikzpicture}
%	
%	\begin{tikzpicture}
%
%\node at (1,-1){};
%	\end{tikzpicture}
%	
%	\subsection{Irregular Sampling Distance and cariable sequence length}
%	
%	\includegraphics[width=\textwidth, height=3cm]{images/days_between_acquisitions}
%	
%	\subsection{Spatial Autocorrelation}
%	 
%	 \includegraphics[width=.66\textwidth]{images/map/breizh}
%	 
	 \section{Outlook}
	 
	 \begin{minipage}{\textwidth}
	 	
	 	\textbf{pre-train} vegetation model on available crop type data
	 	
	 	test \textbf{generalization} over \textbf{changing environmental conditions}
	 	
	 	gather \textbf{\color{tumblue}more crop data} with awarded \\ \textit{Google Research Credits} 

	 \end{minipage}
%	 \begin{minipage}{.38\textwidth}
%	 	\includegraphics[width=\textwidth]{images/map/europe_data.pdf}
%	 	\tiny open crop data regions
%	 \end{minipage}
	 
	 \section{Feedback}
	 
	 \begin{itemize}
	 	\item other baseline models?
	 	\item general interest in this application?
%	 	\item use of the dataset for TS community?
	 	\item ideas to address the challenges?
	 \end{itemize}

	\tiny
	\bibliographystyle{icml2019}
	\bibliography{bib/references.bib}

\end{minipage}


% footer environment places \hfill and sets fontsize
\begin{footer}
	\begin{multicols}{2}
		\textbf{Technical University of Munich}\\
		TUM Department of Civil, Geo and Environmental Engineering \\
		Remote Sensing Technology, Computer Vision Research Group \\
		Arcisstr. 21, 80333 Munich, Germany \\
		www.lmf.bgu.tum.de/vision
	\vfill\columnbreak
	%right
		\textbf{Authors} \\
		Marc Rußwurm \\ (marc.russwurm@tum.de) \\
		Sébastien Lefèvre \\
		Marco Körner \\ (marco.koerner@tum.de)
	\vfill
	\end{multicols}
\end{footer}

\end{document}